<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>内嵌浏览器批量检测系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #2d4059;
        }
        
        h1 {
            color: #4cc9f0;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .subtitle {
            color: #a9a9a9;
            font-size: 1.1rem;
        }
        
        .main-content {
            display: flex;
            gap: 20px;
            height: 75vh;
            margin-bottom: 20px;
        }
        
        .browser-container {
            flex: 3;
            background: #0f1525;
            border-radius: 12px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        }
        
        .browser-header {
            background: #1c2541;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #2d4059;
        }
        
        .browser-controls {
            display: flex;
            gap: 10px;
        }
        
        .control-btn {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        
        .control-btn.close { background: #ff5f57; }
        .control-btn.minimize { background: #ffbd2e; }
        .control-btn.maximize { background: #28ca42; }
        
        .browser-url {
            background: #121a2e;
            border: 1px solid #2d4059;
            border-radius: 20px;
            padding: 8px 15px;
            color: #e0e0e0;
            width: 70%;
            font-size: 0.9rem;
        }
        
        .browser-view {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .browser-frame {
            width: 100%;
            height: 100%;
            border: 1px solid #2d4059;
            border-radius: 8px;
            background: #ffffff;
            overflow: hidden;
        }
        
        .browser-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #555;
            font-size: 1.2rem;
        }
        
        .browser-placeholder i {
            font-size: 4rem;
            color: #4cc9f0;
            margin-bottom: 20px;
        }
        
        .control-panel {
            flex: 1;
            background: #0f1525;
            border-radius: 12px;
            padding: 20px;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        }
        
        .panel-section {
            margin-bottom: 25px;
        }
        
        .panel-title {
            color: #4cc9f0;
            font-size: 1.3rem;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid #2d4059;
        }
        
        .url-list {
            background: #121a2e;
            border-radius: 8px;
            padding: 10px;
            max-height: 150px;
            overflow-y: auto;
            margin-bottom: 15px;
        }
        
        .url-item {
            padding: 8px 10px;
            background: #1c2541;
            margin-bottom: 8px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .url-item:last-child {
            margin-bottom: 0;
        }
        
        .url-text {
            font-size: 0.9rem;
            max-width: 70%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .url-actions {
            display: flex;
            gap: 8px;
        }
        
        .url-btn {
            background: transparent;
            border: none;
            color: #a9a9a9;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .url-btn:hover {
            color: #4cc9f0;
        }
        
        .input-group {
            display: flex;
            margin-bottom: 15px;
        }
        
        .input-group input {
            flex: 1;
            padding: 12px 15px;
            background: #121a2e;
            border: 1px solid #2d4059;
            border-radius: 8px 0 0 8px;
            color: #e0e0e0;
        }
        
        .input-group button {
            padding: 12px 20px;
            background: #2d4059;
            border: 1px solid #2d4059;
            border-left: none;
            border-radius: 0 8px 8px 0;
            color: #e0e0e0;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .input-group button:hover {
            background: #4cc9f0;
            color: #0f1525;
        }
        
        .telegram-groups {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .group-tag {
            background: #1c2541;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .group-tag i {
            color: #4cc9f0;
        }
        
        .group-tag .remove {
            color: #ff5f57;
            cursor: pointer;
            font-size: 1rem;
        }
        
        .button-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }
        
        .action-btn {
            padding: 14px;
            border-radius: 8px;
            border: none;
            background: #2d4059;
            color: #e0e0e0;
            font-size: 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .action-btn:hover {
            background: #4cc9f0;
            color: #0f1525;
            transform: translateY(-2px);
        }
        
        .action-btn.start {
            background: #28a745;
        }
        
        .action-btn.start:hover {
            background: #218838;
            color: #e0e0e0;
        }
        
        .action-btn.stop {
            background: #dc3545;
        }
        
        .action-btn.stop:hover {
            background: #c82333;
            color: #e0e0e0;
        }
        
        .status-panel {
            background: #0f1525;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        }
        
        .status-title {
            color: #4cc9f0;
            font-size: 1.3rem;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid #2d4059;
        }
        
        .status-log {
            background: #121a2e;
            border-radius: 8px;
            padding: 15px;
            height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }
        
        .log-entry {
            padding: 5px 0;
            border-bottom: 1px solid #1c2541;
        }
        
        .log-time {
            color: #a9a9a9;
            margin-right: 10px;
        }
        
        .log-success { color: #28ca42; }
        .log-error { color: #ff5f57; }
        .log-info { color: #4cc9f0; }
        .log-warning { color: #ffbd2e; }
        
        footer {
            text-align: center;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #2d4059;
            color: #a9a9a9;
            font-size: 0.9rem;
        }
        
        /* 响应式调整 */
        @media (max-width: 1200px) {
            .main-content {
                flex-direction: column;
                height: auto;
            }
            
            .browser-container, .control-panel {
                width: 100%;
            }
            
            .browser-container {
                height: 60vh;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-globe"></i> 内嵌浏览器批量检测系统</h1>
            <p class="subtitle">批量操作 | 链接检测 | 自动截图 | Telegram通知</p>
        </header>
        
        <div class="main-content">
            <div class="browser-container">
                <div class="browser-header">
                    <div class="browser-controls">
                        <div class="control-btn close"></div>
                        <div class="control-btn minimize"></div>
                        <div class="control-btn maximize"></div>
                    </div>
                    <input type="text" class="browser-url" id="currentUrl" value="https://example.com" readonly>
                    <div class="browser-actions">
                        <button id="refreshBtn" class="action-btn" style="padding: 5px 15px; font-size: 0.9rem;"><i class="fas fa-redo"></i> 刷新</button>
                    </div>
                </div>
                <div class="browser-view">
                    <div class="browser-frame" id="browserFrame">
                        <div class="browser-placeholder" id="browserPlaceholder">
                            <i class="fas fa-compass"></i>
                            <p>浏览器就绪，点击下方按钮开始批量检测</p>
                            <p>当前URL: <span id="displayUrl">https://example.com</span></p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="control-panel">
                <div class="panel-section">
                    <h3 class="panel-title"><i class="fas fa-link"></i> 待检测URL列表</h3>
                    <div class="url-list" id="urlList">
                        <div class="url-item">
                            <span class="url-text">https://example.com</span>
                            <div class="url-actions">
                                <button class="url-btn" onclick="removeUrl(0)"><i class="fas fa-times"></i></button>
                            </div>
                        </div>
                        <div class="url-item">
                            <span class="url-text">https://google.com</span>
                            <div class="url-actions">
                                <button class="url-btn" onclick="removeUrl(1)"><i class="fas fa-times"></i></button>
                            </div>
                        </div>
                        <div class="url-item">
                            <span class="url-text">https://github.com</span>
                            <div class="url-actions">
                                <button class="url-btn" onclick="removeUrl(2)"><i class="fas fa-times"></i></button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <input type="text" id="newUrl" placeholder="输入要检测的URL (例如: https://example.com)">
                        <button id="addUrlBtn"><i class="fas fa-plus"></i> 添加</button>
                    </div>
                    
                    <div class="input-group">
                        <input type="text" id="batchUrls" placeholder="批量添加URL (每行一个或逗号分隔)">
                        <button id="addBatchBtn"><i class="fas fa-layer-group"></i> 批量添加</button>
                    </div>
                </div>
                
                <div class="panel-section">
                    <h3 class="panel-title"><i class="fab fa-telegram"></i> 绑定Telegram群组</h3>
                    <div class="telegram-groups" id="telegramGroups">
                        <div class="group-tag">
                            <i class="fab fa-telegram"></i> 测试群组
                            <span class="remove" onclick="removeGroup(0)"><i class="fas fa-times"></i></span>
                        </div>
                        <div class="group-tag">
                            <i class="fab fa-telegram"></i> 监控频道
                            <span class="remove" onclick="removeGroup(1)"><i class="fas fa-times"></i></span>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <input type="text" id="newGroup" placeholder="输入Telegram群组ID或用户名">
                        <button id="addGroupBtn"><i class="fas fa-paper-plane"></i> 绑定</button>
                    </div>
                </div>
                
                <div class="panel-section">
                    <h3 class="panel-title"><i class="fas fa-cog"></i> 检测设置</h3>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 8px;">目标Logo选择器:</label>
                        <input type="text" id="logoSelector" value=".logo, header img, .navbar-brand img" style="width: 100%; padding: 10px; background: #121a2e; border: 1px solid #2d4059; border-radius: 8px; color: #e0e0e0;">
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="checkbox" id="autoScreenshot" checked>
                        <label for="autoScreenshot">检测到匹配时自动截图并发送到Telegram</label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button class="action-btn start" id="startBtn">
                        <i class="fas fa-play-circle"></i> 开始批量检测
                    </button>
                    <button class="action-btn" id="testBtn">
                        <i class="fas fa-vial"></i> 测试当前页面
                    </button>
                    <button class="action-btn stop" id="stopBtn" disabled>
                        <i class="fas fa-stop-circle"></i> 停止检测
                    </button>
                </div>
            </div>
        </div>
        
        <div class="status-panel">
            <h3 class="status-title"><i class="fas fa-history"></i> 操作日志</h3>
            <div class="status-log" id="statusLog">
                <div class="log-entry">
                    <span class="log-time">[10:23:45]</span>
                    <span class="log-info">系统初始化完成，等待操作...</span>
                </div>
                <div class="log-entry">
                    <span class="log-time">[10:24:12]</span>
                    <span class="log-success">URL列表加载完成，共3个待检测链接</span>
                </div>
                <div class="log-entry">
                    <span class="log-time">[10:24:30]</span>
                    <span class="log-info">Telegram群组绑定成功: 测试群组, 监控频道</span>
                </div>
            </div>
        </div>
        
        <footer>
            <p>内嵌浏览器批量检测系统 &copy; 2023 | 支持批量操作、链接检测和Telegram自动通知</p>
        </footer>
    </div>

    <script>
        // 模拟数据
        let urls = [
            "https://example.com",
            "https://google.com",
            "https://github.com"
        ];
        
        let telegramGroups = ["测试群组", "监控频道"];
        let isRunning = false;
        let currentUrlIndex = 0;
        let logEntries = [];
        
        // DOM元素
        const urlListEl = document.getElementById('urlList');
        const telegramGroupsEl = document.getElementById('telegramGroups');
        const statusLogEl = document.getElementById('statusLog');
        const displayUrlEl = document.getElementById('displayUrl');
        const currentUrlEl = document.getElementById('currentUrl');
        const browserPlaceholderEl = document.getElementById('browserPlaceholder');
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            updateUrlList();
            updateTelegramGroups();
            
            // 添加URL按钮事件
            document.getElementById('addUrlBtn').addEventListener('click', addUrl);
            document.getElementById('newUrl').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') addUrl();
            });
            
            // 批量添加URL按钮事件
            document.getElementById('addBatchBtn').addEventListener('click', addBatchUrls);
            
            // 添加Telegram群组按钮事件
            document.getElementById('addGroupBtn').addEventListener('click', addTelegramGroup);
            document.getElementById('newGroup').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') addTelegramGroup();
            });
            
            // 开始检测按钮事件
            document.getElementById('startBtn').addEventListener('click', startBatchDetection);
            
            // 停止检测按钮事件
            document.getElementById('stopBtn').addEventListener('click', stopBatchDetection);
            
            // 测试当前页面按钮事件
            document.getElementById('testBtn').addEventListener('click', testCurrentPage);
            
            // 刷新按钮事件
            document.getElementById('refreshBtn').addEventListener('click', refreshBrowser);
            
            // 初始化日志
            addLog("系统初始化完成，等待操作...", "info");
            addLog("URL列表加载完成，共" + urls.length + "个待检测链接", "success");
            addLog("Telegram群组绑定成功: " + telegramGroups.join(", "), "info");
        });
        
        // 添加URL
        function addUrl() {
            const newUrlInput = document.getElementById('newUrl');
            const url = newUrlInput.value.trim();
            
            if (url && isValidUrl(url)) {
                urls.push(url);
                updateUrlList();
                newUrlInput.value = '';
                addLog("已添加URL: " + url, "success");
            } else {
                addLog("无效的URL格式，请检查后重试", "error");
            }
        }
        
        // 批量添加URL
        function addBatchUrls() {
            const batchUrlsInput = document.getElementById('batchUrls');
            const urlsText = batchUrlsInput.value.trim();
            
            if (!urlsText) {
                addLog("请输入要批量添加的URL", "warning");
                return;
            }
            
            // 支持逗号分隔或换行分隔
            let urlArray = urlsText.split(/[\n,]/);
            let addedCount = 0;
            
            urlArray.forEach(url => {
                url = url.trim();
                if (url && isValidUrl(url)) {
                    urls.push(url);
                    addedCount++;
                }
            });
            
            if (addedCount > 0) {
                updateUrlList();
                batchUrlsInput.value = '';
                addLog("批量添加成功，新增" + addedCount + "个URL", "success");
            } else {
                addLog("未找到有效的URL格式，请检查后重试", "warning");
            }
        }
        
        // 移除URL
        function removeUrl(index) {
            if (index >= 0 && index < urls.length) {
                const removedUrl = urls[index];
                urls.splice(index, 1);
                updateUrlList();
                addLog("已移除URL: " + removedUrl, "info");
            }
        }
        
        // 更新URL列表显示
        function updateUrlList() {
            urlListEl.innerHTML = '';
            
            if (urls.length === 0) {
                urlListEl.innerHTML = '<div class="url-item" style="justify-content: center; color: #a9a9a9;">暂无URL，请添加</div>';
                return;
            }
            
            urls.forEach((url, index) => {
                const urlItem = document.createElement('div');
                urlItem.className = 'url-item';
                urlItem.innerHTML = `
                    <span class="url-text">${url}</span>
                    <div class="url-actions">
                        <button class="url-btn" onclick="removeUrl(${index})"><i class="fas fa-times"></i></button>
                    </div>
                `;
                urlListEl.appendChild(urlItem);
            });
        }
        
        // 添加Telegram群组
        function addTelegramGroup() {
            const newGroupInput = document.getElementById('newGroup');
            const group = newGroupInput.value.trim();
            
            if (group) {
                telegramGroups.push(group);
                updateTelegramGroups();
                newGroupInput.value = '';
                addLog("已绑定Telegram群组: " + group, "success");
            } else {
                addLog("群组名称不能为空", "error");
            }
        }
        
        // 移除Telegram群组
        function removeGroup(index) {
            if (index >= 0 && index < telegramGroups.length) {
                const removedGroup = telegramGroups[index];
                telegramGroups.splice(index, 1);
                updateTelegramGroups();
                addLog("已移除Telegram群组: " + removedGroup, "info");
            }
        }
        
        // 更新Telegram群组显示
        function updateTelegramGroups() {
            telegramGroupsEl.innerHTML = '';
            
            if (telegramGroups.length === 0) {
                telegramGroupsEl.innerHTML = '<div style="color: #a9a9a9; padding: 10px;">暂无绑定群组</div>';
                return;
            }
            
            telegramGroups.forEach((group, index) => {
                const groupTag = document.createElement('div');
                groupTag.className = 'group-tag';
                groupTag.innerHTML = `
                    <i class="fab fa-telegram"></i> ${group}
                    <span class="remove" onclick="removeGroup(${index})"><i class="fas fa-times"></i></span>
                `;
                telegramGroupsEl.appendChild(groupTag);
            });
        }
        
        // 开始批量检测
        function startBatchDetection() {
            if (urls.length === 0) {
                addLog("没有待检测的URL，请先添加", "warning");
                return;
            }
            
            if (telegramGroups.length === 0) {
                addLog("未绑定Telegram群组，检测结果将无法发送", "warning");
            }
            
            isRunning = true;
            currentUrlIndex = 0;
            
            document.getElementById('startBtn').disabled = true;
            document.getElementById('stopBtn').disabled = false;
            
            addLog("开始批量检测，共" + urls.length + "个URL待检测", "info");
            
            // 开始处理第一个URL
            processNextUrl();
        }
        
        // 处理下一个URL
        function processNextUrl() {
            if (!isRunning || currentUrlIndex >= urls.length) {
                stopBatchDetection();
                return;
            }
            
            const url = urls[currentUrlIndex];
            addLog("正在检测URL (" + (currentUrlIndex + 1) + "/" + urls.length + "): " + url, "info");
            
            // 更新浏览器显示
            displayUrlEl.textContent = url;
            currentUrlEl.value = url;
            
            // 模拟检测过程
            setTimeout(() => {
                // 模拟随机检测结果
                const isMatch = Math.random() > 0.3; // 70%匹配率
                
                if (isMatch) {
                    addLog("检测成功: URL匹配预设链接，正在截图...", "success");
                    
                    // 模拟截图和发送到Telegram
                    simulateScreenshotAndSend(url);
                } else {
                    addLog("检测失败: URL不匹配预设链接", "error");
                }
                
                // 处理下一个URL
                currentUrlIndex++;
                if (currentUrlIndex < urls.length) {
                    setTimeout(processNextUrl, 1500);
                } else {
                    stopBatchDetection();
                }
            }, 2000);
        }
        
        // 模拟截图并发送到Telegram
        function simulateScreenshotAndSend(url) {
            addLog("截图完成，正在发送到绑定的Telegram群组...", "info");
            
            // 模拟发送到每个绑定的群组
            telegramGroups.forEach(group => {
                setTimeout(() => {
                    addLog("截图已发送到Telegram群组: " + group, "success");
                }, 500);
            });
        }
        
        // 停止检测
        function stopBatchDetection() {
            isRunning = false;
            
            document.getElementById('startBtn').disabled = false;
            document.getElementById('stopBtn').disabled = true;
            
            if (currentUrlIndex >= urls.length) {
                addLog("批量检测完成，已处理" + urls.length + "个URL", "success");
            } else {
                addLog("检测已停止，已处理" + currentUrlIndex + "个URL", "warning");
            }
        }
        
        // 测试当前页面
        function testCurrentPage() {
            const url = currentUrlEl.value;
            if (!url) {
                addLog("当前浏览器没有URL", "error");
                return;
            }
            
            addLog("开始测试当前页面: " + url, "info");
            
            // 模拟检测过程
            setTimeout(() => {
                const isMatch = Math.random() > 0.5; // 50%匹配率
                
                if (isMatch) {
                    addLog("测试成功: URL匹配预设链接", "success");
                    
                    // 检查是否启用自动截图
                    if (document.getElementById('autoScreenshot').checked) {
                        addLog("自动截图功能已启用，正在截图并发送到Telegram...", "info");
                        simulateScreenshotAndSend(url);
                    }
                } else {
                    addLog("测试失败: URL不匹配预设链接", "error");
                }
            }, 1500);
        }
        
        // 刷新浏览器
        function refreshBrowser() {
            const url = currentUrlEl.value;
            addLog("刷新浏览器: " + url, "info");
            
            // 模拟刷新效果
            browserPlaceholderEl.innerHTML = `
                <i class="fas fa-sync fa-spin"></i>
                <p>正在加载页面...</p>
                <p>当前URL: <span id="displayUrl">${url}</span></p>
            `;
            
            setTimeout(() => {
                browserPlaceholderEl.innerHTML = `
                    <i class="fas fa-compass"></i>
                    <p>页面加载完成</p>
                    <p>当前URL: <span id="displayUrl">${url}</span></p>
                `;
                displayUrlEl = document.getElementById('displayUrl');
                addLog("页面刷新完成: " + url, "success");
            }, 1000);
        }
        
        // 添加日志
        function addLog(message, type = "info") {
            const time = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit', second:'2-digit'});
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            
            let typeClass = 'log-info';
            if (type === 'success') typeClass = 'log-success';
            else if (type === 'error') typeClass = 'log-error';
            else if (type === 'warning') typeClass = 'log-warning';
            
            logEntry.innerHTML = `
                <span class="log-time">[${time}]</span>
                <span class="${typeClass}">${message}</span>
            `;
            
            statusLogEl.appendChild(logEntry);
            statusLogEl.scrollTop = statusLogEl.scrollHeight;
            
            // 保存日志条目
            logEntries.push({time, message, type});
        }
        
        // 验证URL格式
        function isValidUrl(string) {
            try {
                new URL(string);
                return true;
            } catch (_) {
                return false;
            }
        }
    </script>
</body>
</html>
